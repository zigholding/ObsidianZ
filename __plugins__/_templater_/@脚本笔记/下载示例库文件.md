---
PrevNote: "[[LLM - ÊÄªÁªìÁ¨îËÆ∞]]"
words:
  2025-02-06: 368
  2025-02-08: 730
  2025-02-09: 559
  2025-02-10: 558
  2025-02-20: 564
  2025-02-21: 605
  2025-05-08: 677
NextNote: "[[Êé•ÂäõËÅäÂ§©]]"
NIW: ËÑöÊú¨Áî®‰∫é‰ªéGiteeÊàñGithub‰∏ãËΩΩÁ¥¢ÂºïÁ¨îËÆ∞„ÄÅËÑöÊú¨Á¨îËÆ∞„ÄÅJS‰ª£Á†ÅÊàñÊèí‰ª∂ÔºåÊîØÊåÅÈÄâÊã©ÊÄß‰∏ãËΩΩÂíåÊâπÈáè‰∏ãËΩΩ„ÄÇ
---


Êú¨ËÑöÊú¨ÂèØ‰ª•Êñπ‰æø‰ªé [[Gitee]] Êàñ [[Github]] ‰∏ãËΩΩÁ¥¢ÂºïÁ¨îËÆ∞„ÄÅËÑöÊú¨Á¨îËÆ∞„ÄÅJS‰ª£Á†ÅÊàñÊèí‰ª∂„ÄÇ

Âú®`js //templater' ‰ª£Á†ÅÂùó‰∏≠ÈÖçÁΩÆÊÉ≥Ë¶Å‰∏ãËΩΩÁöÑÁ§∫‰æãÂ∫ìÔºö

```js
let SOURCE = 'gitee'; // gitee Êàñ github
let repoOwner = 'zigholding'; // ÂºÄÂèëËÄÖ
let repoName = 'ObsidianZ'; // È°πÁõÆÂêçÁß∞
let path = '__plugins__';  // ÂàùÂßãË∑ØÂæÑ
let branch = 'master'; // ÂàÜÊîØÂêçÁß∞
```

ËøêË°åËÑöÊú¨Á¨îËÆ∞Ôºå‰ºöÊòæÁ§∫ÂºπÁ™óÔºåÂØπÂ∫î `path` ‰∏ãÁöÑÂ≠êÊñá‰ª∂Ôºö
![[Pasted image 20250209180311.png]]

Âú®ÂºπÁ™ó‰∏≠ÈÄâÊã©ÊÉ≥Ë¶Å‰∏ãËΩΩÁöÑÊñá‰ª∂„ÄÇ

- ÁÇπÂáªÊñá‰ª∂Êó∂Ôºå‰ºö‰∏ãËΩΩÂØπÂ∫îÁöÑÊñá‰ª∂Âà∞Êú¨Âú∞Â∫ìÔºåË∑ØÂæÑÂíå git È°πÁõÆ‰∏ÄËá¥Ôºõ
- ÁÇπÂáªÁõÆÂΩïÊó∂ÔºåÊñ∞ÂºπÁ™óÁΩóÂàóÁõÆÂΩïÂ≠êÊñá‰ª∂ÔºåÁªßÁª≠ÁÇπÂáªÁõÆÂΩïÊàñÊñá‰ª∂ÔºåÁõ¥Âà∞ÈÄâÊã©ÂÖ∑‰ΩìÁöÑÊñá‰ª∂‰∏∫Ê≠¢Ôºõ

Â¶ÇÊûúÊÉ≥‰∏ãËΩΩÂΩìÂâçÁõÆÂΩï‰∏ãÁöÑÊâÄÊúâÊñá‰ª∂ÔºåËæìÂÖ• `all`ÔºåÁÇπÂáªÂõûËΩ¶Á°ÆËÆ§„ÄÇËÑöÊú¨‰ºö‰∏ãËΩΩÊâÄÊúâÊñá‰ª∂Ôºå‰∏çÂåÖÂê´Â≠êÁõÆÂΩï„ÄÇ

![[Pasted image 20250209180045.png]]

ËÑöÊú¨‰ª£Á†ÅÔºö

```js //templater
let SOURCE = 'gitee'; // gitee
let repoOwner = 'zigholding'; // ÂºÄÂèëËÄÖ
let repoName = 'ObsidianZ'; // È°πÁõÆÂêçÁß∞
let path = '__plugins__';  // ÂàùÂßãË∑ØÂæÑ
let branch = 'master'; // ÂàÜÊîØÂêçÁß∞

async function list_files_of_path(repoOwner, repoName, path, branch = 'master') {
	let url;
	if(SOURCE=='github'){
		url = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${path}?ref=${branch}`;
	}else{
		url = `https://gitee.com/api/v5/repos/${repoOwner}/${repoName}/contents/${path}?ref=${branch}`
	}
	let req = await requestUrl(url)
	req = JSON.parse(req.text)
	if(!Array.isArray(req)){
		req = [req]
	}
	return req
}

async function download_file(url,folder_path,file_name){
	console.log(url,folder_path,file_name)
	let req = await requestUrl(url)
	// req = JSON.parse(req.text)
	// let ctx = atob(req.content)
	ctx = req.text
	let tfile_path = `${folder_path}/${file_name}`
	// console.log(ctx)
	if(folder_path.startsWith('.')){
		let flag = await app.vault.exists(folder_path);
		if(!flag){
			await app.vault.createFolder(folder_path)
		}
		flag = await app.vault.exists(tfile_path);
		if(!app.vault.exists(tfile_path)){
			await app.vault.adapter.remove(tfile_path)
		}
		tfile = await app.vault.create(tfile_path,ctx)
	}else{
		let folder = app.vault.getFolderByPath(folder_path)
		if(!folder){
			folder = await app.vault.createFolder(folder_path)
		}
		
		let tfile = app.vault.getFileByPath(tfile_path)
		if(!tfile){
			tfile = await app.vault.create(tfile_path,ctx)
			new Notice(`‰∏ãËΩΩÔºö${tfile.path}`,5000)
		}else{
			await app.vault.modify(tfile,ctx)
			new Notice(`Êõ¥Êñ∞Ôºö${tfile.path}`,5000)
		}
	}
}

async function download_files(repoOwner, repoName, path, branch,recursive=false){
	let items = await list_files_of_path(repoOwner, repoName, path, branch);
	for(let item of items){
		if(item.type=='file'){
			let file_name = item.path.split('/').last();
			let folder_path = item.path.slice(0,item.path.length-file_name.length-1);
			await download_file(item.download_url,folder_path,file_name);
		}else if(item.type=='dir' && recursive){
			await download_files(repoOwner, repoName, item.path, branch,recursive);
		}
	}
}


async function download_file_of_dir(repoOwner, repoName, path, branch){
	let items = await list_files_of_path(repoOwner, repoName, path, branch)
	nc=app.plugins.getPlugin('note-chain');
	let item = await nc.dialog_suggest(
		items.map(x=>(x.type=='file'?'üìÉ':'üìÅ')+x.path),
		items,'Type "all/ALL" to download all file!',true
	);
	if(!item){return}
	if(typeof(item)=='string' && item=='all'){
		if(item=='all'){
			download_files(repoOwner, repoName, path, branch);
		}else if(item='ALL'){
			download_files(repoOwner, repoName, path, branch,true);
		}
	}else if(item.type=='file'){
		let file_name = item.path.split('/').last();
		let folder_path = item.path.slice(0,item.path.length-file_name.length-1);
		await download_file(item.download_url,folder_path,file_name)
	}else if(item.type=='dir'){
		await download_file_of_dir(repoOwner, repoName, item.path, branch)
	}
}

path = ''; 
download_file_of_dir(repoOwner, repoName, path, branch)
```

